import{d as u,r as d,_ as I,D as i,J as l,E as N,N as p,M as f,j as s,G as g,H as c,I as w,K as y,ar as b,as as k}from"./index.758da505.js";import{Q as C}from"./QImg.92ead9aa.js";import{a as $}from"./QCard.37bf516d.js";import{Q as v}from"./format.0584e0b6.js";import{a as h}from"./index.b6409fd5.js";const x=u({name:"ImageUploaderComp",props:{circleBorder:{type:Boolean,default:!1},imageIdx:{type:String,default:"0"},boxLength:{type:Number,default:0},fetchedImage:{type:String||Number}},components:{},setup(){return{image:d(null),fileNewName:d(null),loader:d(!1)}},methods:{chooseImage(){this.$refs.fileInput.click()},async onSelectImage(){this.loader=!0;const a=this.$refs.fileInput.files;if(a&&a[0]){const m=new FileReader;m.onload=o=>{this.image=o.target.result},m.readAsDataURL(a[0]),this.$emit("input",a[0]);const n=new FormData;n.append("image",a[0]);const r=await h.main.upload({fd:n});if(r.data.success){const o=r.data.files.map(t=>t.filename);this.fileNewName=o[0],this.$emit("image-inputs",this.fileNewName)}}this.loader=!1},async deleteImage(){this.fileNewName&&(this.loader=!0,this.$emit("remove-image-input",this.fileNewName),await h.main.uploadDeleteFile({filename:this.fileNewName}),this.fileNewName=null,this.image=null,this.$refs.fileInput.value=null,this.loader=!1)},async deleteUploadBox(){await this.deleteImage(),this.$emit("delete-image-box",this.imageIdx)}},mounted(){this.fetchedImage&&this.fetchedImage.slice(0,5)=="image"&&(this.image=this.fetchedImage,this.fileNewName=this.fetchedImage)}}),_=e=>(b("data-v-b3bf310a"),e=e(),k(),e),B={class:"text-right"},S={key:0},U={class:"text-center"},Q=_(()=>c("br",null,null,-1)),q={key:0,class:"text-caption"};function D(e,a,m,n,r,o){return i(),l("div",B,[e.imageIdx!=1?(i(),N(p,{key:0,onClick:e.deleteUploadBox,class:"text-pointer text-red",color:"red",size:"sm",name:"mdi-minus-circle"},null,8,["onClick"])):f("",!0),s($,{flat:"",style:{width:"100px",height:"100px",overflow:"hidden"},class:y(["pointer q-mx-xs q-mb-xs q-px-sm",(e.image?"q-py-xs ":"q-py-lg ")+(!e.image&&e.circleBorder?"ad-profile-box":"ad-image-box")])},{default:g(()=>[e.image?(i(),l("div",S,[s(C,{onClick:e.deleteImage,width:"90",height:"80",src:e.image.slice(0,5)==="image"?e.$api.defaults.baseURL+"/public/wsm/"+e.image:e.image},{default:g(()=>[s(p,{size:"md",class:"text-red",name:"mdi-delete"})]),_:1},8,["onClick","src"])])):(i(),l("div",{key:1,class:"text-primary text-center centering",onClick:a[0]||(a[0]=(...t)=>e.chooseImage&&e.chooseImage(...t))},[c("span",U,[s(p,{size:"md",color:"primary",name:"mdi-image"}),Q,e.boxLength==1?(i(),l("span",q,w(e.$t("addImage")),1)):f("",!0)])])),c("input",{hidden:"",ref:"fileInput",accept:"image/*",type:"file",onInput:a[1]||(a[1]=(...t)=>e.onSelectImage&&e.onSelectImage(...t))},null,544)]),_:1},8,["class"]),s(v,{showing:e.loader},null,8,["showing"])])}var E=I(x,[["render",D],["__scopeId","data-v-b3bf310a"]]);export{E as I};
