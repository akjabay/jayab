import{Q as m}from"./QToggle.ad15b1a4.js";import{b as c,Q as u}from"./use-dark.d08f1f81.js";import{_ as f,d as h,r,B as g,D as y,E as $,G as e,C as Q,H as p,j as o,L as v,I as _,N as A}from"./index.758da505.js";import{Q as M}from"./QCardSection.9e482b55.js";import{Q as b,a as O}from"./QCard.37bf516d.js";import{Q as C}from"./QDialog.49e4cb1e.js";import{Q as V}from"./format.0584e0b6.js";import{M as w}from"./MapComp.decf5a7c.js";import{a as P}from"./index.b6409fd5.js";import"./use-form.dadb0a3a.js";import"./focusout.e509f8ae.js";import"./focus-manager.32f8d49a.js";import"./use-transition.f0850e0a.js";import"./MapAddPointComp.81f183ed.js";import"./QSeparator.159b8493.js";import"./QInput.5c706ea3.js";import"./FilterComp.7309b231.js";import"./CityComp.e4e85926.js";import"./selection.31cc2582.js";import"./QCardActions.e5c1e1cc.js";import"./QItemLabel.1bcc401f.js";import"./QMenu.d44f46b3.js";import"./ClosePopup.27b22d3b.js";import"./ImageUploaderComp.969c6c46.js";import"./QImg.92ead9aa.js";import"./SubTitleComp.29d95159.js";import"./axios.0e7880b2.js";const q=h({name:"ManageMapPage",components:{MapComp:w},setup(){return{isActive:r(!1),loaded:r(!1),products:r([]),pagination:r({limit:10,offset:0,total:1})}},methods:{async fetch(){try{this.loaded=!1,this.$route.query&&this.$route.query.adding&&(this.isActive=!0),(!this.user||!this.user.city)&&(this.$q.notify({type:"warning",message:this.$t("setCityIsRequired"),caption:this.$t("failed")}),this.$router.push("/accounts/profile/setting"));const t={};this.filterOptions&&typeof this.filterOptions=="object"&&Object.keys(this.filterOptions).forEach(i=>{typeof this.filterOptions[i]=="object"&&Object.keys(this.filterOptions[i]).includes("min")?t[i]=`${this.filterOptions[i].min},${this.filterOptions[i].max}`:t[i]=this.filterOptions[i]});const s=await P.product.productFindMyProducts({sorting:"cteaedAt: -1",latlng:this.user&&this.user.city?this.user.city.lat_long:"",isMap:!0,...t});if(s.status===200){const i=s.data.data.productFindMyProducts.hits;this.products=i,this.pagination=s.data.data.productFindMyProducts.pagination,this.$refs.map.onAddingMarker({markers:this.products});const a=this.user&&this.user.city?this.user.city.lat_long:"",d=a?{latitude:a.split(",")[0],longitude:a.split(",")[1]}:{};this.$refs.map.setCurrentPositionMap({location:d})}this.loaded=!0}catch(t){this.loaded=!0,console.log(t),this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}this.loaded=!0}},mounted(){this.fetch()},computed:{...g(c,["user"])}}),j={class:"text-center q-ma-sm ad-box-bordered"},S=p("div",null," \u0644\u0637\u0641\u0627 \u0645\u06A9\u0627\u0646 \u0645\u0644\u06A9 \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u062E\u0648\u062F \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F ",-1);function x(t,s,i,a,d,B){const l=Q("map-comp");return y(),$(b,null,{default:e(()=>[p("div",null,[p("div",j,[o(m,{class:"ad-font-color",modelValue:t.isActive,"onUpdate:modelValue":s[0]||(s[0]=n=>t.isActive=n)},{default:e(()=>[v(_("\u0627\u0641\u0632\u0648\u062F\u0646 \u0648 \u0648\u06CC\u0631\u0627\u06CC\u0634 \u0645\u0644\u06A9"))]),_:1},8,["modelValue"])]),o(C,{modelValue:t.isActive,"onUpdate:modelValue":s[1]||(s[1]=n=>t.isActive=n),seamless:"",position:"bottom"},{default:e(()=>[o(O,{style:{width:"350px"},class:"ad-box-bordered ad-font-color"},{default:e(()=>[o(M,{class:"row items-center no-wrap"},{default:e(()=>[S,o(u),o(A,{size:"lg",name:"fa fa-location"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(l,{isAdding:t.isActive,ref:"map"},null,8,["isAdding"])]),o(V,{showing:!t.loaded},null,8,["showing"])]),_:1})}var pt=f(q,[["render",x]]);export{pt as default};
