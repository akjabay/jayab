import{Q as S}from"./format.0584e0b6.js";import{a as B,Q as M}from"./QCard.37bf516d.js";import{b as C}from"./use-dark.d08f1f81.js";import{d as P,_ as q,D as o,J as p,F as Q,R as N,H as a,j as s,N as y,I as u,K as A,r as d,B as F,C as l,E as h,G as r,P as k,Q as _,L as $,M as U,A as D}from"./index.758da505.js";import{a as v}from"./index.b6409fd5.js";import{M as R}from"./MainTitleComp.b5d88647.js";import{I as z}from"./ImageComp.f732b1f6.js";import{L as E}from"./ListComp.d2ac8016.js";import{E as b}from"./EmptyComp.de87cb4a.js";import{P as O}from"./PaginationComp.b7fd894a.js";import"./use-transition.f0850e0a.js";import"./axios.0e7880b2.js";import"./QCardSection.9e482b55.js";import"./QCardActions.e5c1e1cc.js";import"./QDialog.49e4cb1e.js";import"./focusout.e509f8ae.js";import"./focus-manager.32f8d49a.js";import"./ClosePopup.27b22d3b.js";import"./QImg.92ead9aa.js";import"./CategoryComp.e7feb518.js";import"./QInput.5c706ea3.js";import"./use-form.dadb0a3a.js";const T=P({name:"BarComp",props:{navs:{type:Array,required:!0},navValue:{type:Number,rewuired:!0}},setup:()=>({})}),j={class:"row justify-center"},G=["onClick"];function H(e,t,n,i,c,w){return o(),p("div",j,[(o(!0),p(Q,null,N(e.navs,(f,m)=>(o(),p("div",{key:m},[a("div",{class:A(["pointer q-pa-md q-mx-xs",e.navValue==m?"nav-active":null]),onClick:g=>e.$emit("nav-change",m)},[s(y,{class:"q-ml-sm",name:f.item_icon},null,8,["name"]),a("span",null,u(f.item),1)],10,G)]))),128))])}var J=q(T,[["render",H],["__scopeId","data-v-746e75d4"]]);const K=P({name:"ProfileComp",components:{ImageComp:z,BarComp:J,ListComp:E,EmptyComp:b,PaginationComp:O},props:{loadedUser:Object},setup(){return{navs:d([{item:"\u0627\u0645\u0644\u0627\u06A9",item_icon:"fa fa-building"},{item:"\u062B\u0628\u062A \u062A\u0642\u0627\u0636\u0627",item_icon:"fa fa-paper-plane"}]),navValue:d(0),isRealStateOwner:d(!1),products:d([]),currentPage:d(1),pagination:d({limit:10,offset:0,total:1})}},methods:{onCopy(){navigator.clipboard.writeText(window.location.href),this.$q.notify({type:"positive",message:this.$t("success"),caption:this.$t("copyProfileURL")})},async onChangePage(e){await this.fetchData({page:e}),this.currentPage=e},async fetchData(e=[]){try{const{page:t}=e;t&&(this.pagination.offset=(t-1)*this.pagination.limit);const n=this.$route.params.userId;if(this.user&&this.user.username&&n===this.user.username){const i=await v.product.productFindMyProducts({limit:this.pagination.limit,offset:this.pagination.offset,sorting:"cteaedAt: -1"});if(i.status===200){const c=i.data.data.productFindMyProducts.hits;this.products=c,this.pagination=i.data.data.productFindMyProducts.pagination}}else{const i=await v.product.productFindUserProducts({username:n,limit:this.pagination.limit,offset:this.pagination.offset,sorting:"cteaedAt: -1"});if(i.status===200){const c=i.data.data.productFindUserProducts.hits;this.products=c,this.pagination=i.data.data.productFindUserProducts.pagination}}this.loaded=!0}catch(t){console.log(t),this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}}},mounted(){this.fetchData(),this.user&&this.user.permissions&&(this.isRealStateOwner=this.user.permissions.find(e=>e.codename==="write product"))},computed:{...F(C,["isUserLoggedIn","user"])}}),W={class:""},X={class:"text-center"},Y={class:"q-ma-md"},Z={class:"q-my-sm"},x={class:"text-h5"},ee={class:"text-normal",style:{opacity:"0.8"}},te=["href"],se={class:"q-px-lg q-py-xs q-mr-lg bg-green",style:{"border-radius":"25pc",color:"white"}},ae={class:"q-px-xs"},oe={key:0,class:"q-my-sm text-center"},ie=a("hr",{class:"line-style-two",style:{"margin-bottom":"0"}},null,-1),ne={key:1},re={key:2};function de(e,t,n,i,c,w){const f=l("image-comp"),m=l("bar-comp"),g=l("list-comp"),V=l("pagination-comp"),I=l("empty-comp");return o(),h(B,{flat:"",tile:""},{default:r(()=>[a("div",W,[a("div",X,[a("div",Y,[e.loadedUser.avatar_url?(o(),h(k,{key:0,size:"90px"},{default:r(()=>[s(f,{link:e.loadedUser.avatar_url,isThumb:!0},null,8,["link"])]),_:1})):(o(),h(k,{key:1,size:"90px",color:"blue-grey-2"},{default:r(()=>[s(y,{name:"person"})]),_:1}))]),a("div",Z,[a("div",x,u(e.loadedUser.name||e.loadedUser.id),1),a("div",ee,u(e.loadedUser.email),1)]),s(_,{size:"lg",class:"ad-font-color",outline:"",rounded:""},{default:r(()=>[a("span",null,u(e.loadedUser.phone),1),a("a",{class:"",href:`tel:${e.loadedUser.phone}`},[a("span",se,[s(y,{size:"sm",class:"q-px-sm",name:"fa fa-phone"})])],8,te)]),_:1}),e.isUserLoggedIn&&(e.user.id==e.loadedUser.id||e.user.is_superuser==1)?(o(),h(_,{key:0,onClick:e.onCopy,class:"q-ma-xs q-px-md ad-font-color",outline:"",rounded:""},{default:r(()=>[a("span",ae,[s(y,{name:"fa fa-copy"})]),$(" "+u(e.$t("copyProfileURL")),1)]),_:1},8,["onClick"])):U("",!0)]),e.isUserLoggedIn&&(e.user.id==e.loadedUser.id||e.user.is_superuser==1)?(o(),p("div",oe,[a("div",null,[s(_,{to:"/accounts/profile/setting/"+e.loadedUser.username,class:"q-mx-xs q-px-md",outline:"",rounded:"",dense:""},{default:r(()=>[$(u(e.$t("accountSettings")),1)]),_:1},8,["to"]),e.isRealStateOwner?(o(),h(_,{key:0,onClick:t[0]||(t[0]=()=>e.$router.push("/accounts/plus")),class:"q-mx-xs q-px-md",outline:"",rounded:"",dense:""},{default:r(()=>[$(u(e.$t("manageStates")),1)]),_:1})):U("",!0)])])):U("",!0),ie,s(m,{navs:e.navs,navValue:e.navValue,onNavChange:t[1]||(t[1]=L=>e.navValue=L)},null,8,["navs","navValue"]),e.products.length>0&&e.navValue===0?(o(),p("div",ne,[s(g,{items:e.products},null,8,["items"]),s(V,{onSelectPage:e.onChangePage,currentPage:e.currentPage,pagination:e.pagination},null,8,["onSelectPage","currentPage","pagination"])])):(o(),p("div",re,[s(I)]))])]),_:1})}var le=q(K,[["render",de]]);const pe=P({name:"ProfilePage",components:{MainTitleComp:R,ProfileComp:le,EmptyComp:b},setup(){return{loadedUser:d({}),loaded:d(!1)}},methods:{...D(C,["setUser"]),async fetchData(){try{const e=this.$route.params.userId;if(e){const t=await v.user.userFind({username:e});t.data.errors?this.$q.notify({type:"warning",message:this.$t("failed"),caption:t.data.errors[0]}):t.data.data.userFind&&(this.loadedUser=t.data.data.userFind)}else if(!e){const t=await v.auth.authFindMe();if(t.data.errors)this.$q.notify({type:"warning",message:this.$t("failed"),caption:this.$t("userNotFound")});else if(t.data.data.authFindMe.id){const n=t.data.data.authFindMe;this.loadedUser=n,this.setUser(n)}}this.loaded=!0}catch(e){const t=new Error(e);console.log(t),this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}}},mounted(){this.fetchData()},computed:{...F(C,["user"])}}),me={key:0},ue={key:1};function ce(e,t,n,i,c,w){const f=l("main-title-comp"),m=l("profile-comp"),g=l("empty-comp");return o(),h(M,null,{default:r(()=>[s(f,{title:e.$t("profile")},null,8,["title"]),e.loadedUser&&e.loadedUser.id?(o(),p("div",me,[s(m,{loadedUser:e.loadedUser},null,8,["loadedUser"])])):(o(),p("div",ue,[s(g)])),s(S,{showing:!e.loaded},null,8,["showing"])]),_:1})}var Ne=q(pe,[["render",ce]]);export{Ne as default};
