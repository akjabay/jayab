import{Q as m}from"./QInput.5c706ea3.js";import{d as D,h as Q,_ as P,r as o,A as U,D as p,E as M,G as a,C as q,H as n,j as s,J as B,L as r,I as l,Q as c,aw as H,M as V}from"./index.758da505.js";import{Q as S}from"./QCardSection.9e482b55.js";import{b as R,Q as F}from"./use-dark.d08f1f81.js";import{Q as G}from"./QCardActions.e5c1e1cc.js";import{Q as j,a as b}from"./QCard.37bf516d.js";import{a as C}from"./index.b6409fd5.js";import{M as Y}from"./MainTitleComp.b5d88647.js";import{C as z}from"./CityComp.e4e85926.js";import"./use-form.dadb0a3a.js";import"./focus-manager.32f8d49a.js";import"./axios.0e7880b2.js";import"./QSeparator.159b8493.js";import"./selection.31cc2582.js";import"./focusout.e509f8ae.js";import"./format.0584e0b6.js";import"./use-transition.f0850e0a.js";import"./QDialog.49e4cb1e.js";/*! vue-countdown v2.1.0 | (c) 2018-present Chen Fengyuan | MIT */const f=1e3,y=60*f,g=60*y,w=24*g,E="abort",I="end",N="progress",k="start",T="visibilitychange";var J=D({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:t=>t>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:t=>t>=0},transform:{type:Function,default:t=>t}},emits:[E,I,N,k],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/w)},hours(){return Math.floor(this.totalMilliseconds%w/g)},minutes(){return Math.floor(this.totalMilliseconds%g/y)},seconds(){return Math.floor(this.totalMilliseconds%y/f)},milliseconds(){return Math.floor(this.totalMilliseconds%f)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/g)},totalMinutes(){return Math.floor(this.totalMilliseconds/y)},totalSeconds(){return Math.floor(this.totalMilliseconds/f)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(T,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(T,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.emitEvents&&this.$emit(k),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const t=Math.min(this.totalMilliseconds,this.interval);if(t>0){let e,d;const h=u=>{e||(e=u),d||(d=u);const $=u-e;$>=t||$+(u-d)/2>=t?this.progress():this.requestId=requestAnimationFrame(h),d=u};this.requestId=requestAnimationFrame(h)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){!this.counting||(this.totalMilliseconds-=this.interval,this.emitEvents&&this.totalMilliseconds>0&&this.$emit(N,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){!this.counting||(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(E))},end(){!this.counting||(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(I))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return Q(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const K=D({name:"SignupPage",components:{MainTitleComp:Y,VueCountdown:J,CityComp:z},setup(){return{name:o(""),email:o(""),phone:o(""),address:o(""),password:o(""),confirmPassword:o(""),city:o({}),provinces:o([]),code:o(""),countDownTime:o(5*60*1e3),rules:o({}),form1:o(!0),form2:o(!1),user:o({}),disable:o(!1),loading:o(!1)}},methods:{...U(R,["setUser","setToken"]),onSelectCity(t){this.city=t},async register(){this.loading=!0;try{if(this.password!=this.confirmPassword)return this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("passwordsAreNotMatch")});const t=await C.auth.authSignup({name:this.name,email:this.email,phone:this.phone,address:this.address,password:this.password,cityId:this.city?this.city.id:""});t.data.errors?this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")}):t.data.data.authSignup.id?(this.user=t.data.data.authSignup,this.form1=!1,this.form2=!1,this.form2=!0,this.$q.notify({type:"positive",message:this.$t("success"),caption:this.$t("successRegister")})):this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}catch(t){this.loading=!1,console.log(t,"error on fecth data"),this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}this.loading=!1},async codeVerify(){this.loading=!0;try{const t=await C.auth.authVerify({email:this.email,password:this.password,code:this.code});if(t.data.errors)this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")});else if(t.data.data.authVerify.token){const e=t.data.data.authVerify.user;this.setUser(e),this.setToken(t.data.data.authVerify.token),this.$router.push({path:"/"})}else this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}catch(t){console.log(t,"error on fecth data"),this.loading=!1,this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}this.loading=!1},filterFn(t,e){e(()=>{if(t==="")this.filterOptions=options;else{const d=t.toLowerCase();this.filterOptions=options.filter(h=>h.name.toLowerCase().indexOf(d)>-1)}})},async fetchData(){try{const t=await C.main.getProvinces();if(t.status===200){const e=t.data.data;this.provinces=e}}catch(t){const e=new Error(t);console.log(e),this.$q.notify({type:"negative",message:this.$t("failed"),caption:this.$t("failed")})}}},mounted(){this.rules={required:t=>!!t||this.$t("required"),min3:t=>t.length>=3||this.$t("min3Character"),min8:t=>t.length>=8||this.$t("min8Character"),is11:t=>t.length==11||this.$t("is11Character"),email:(t,e)=>e.email(t)||this.$t("havetoBeValidEmail")},this.fetchData()}}),W={class:"row justify-center text-center q-mt-xl"},X={class:"col-12 col-md-4 col-sm-6 text-center"},Z={key:0,class:"q-py-sm q-mx-sm"},_={class:"col-12 text-center"},x={class:"col-12 text-center"},tt={class:"text-h5 text-center ad-font-color q-pa-sm q-mb-sm"},et={class:"text-h5 ad-font-color"},st=n("span",{class:"text-h6 text-bold"},"12321",-1);function it(t,e,d,h,u,$){const A=q("main-title-comp"),L=q("city-comp"),O=q("vue-countdown");return p(),M(j,null,{default:a(()=>[n("div",W,[n("div",X,[s(A,{title:t.$t("signup")},null,8,["title"]),t.form1?(p(),B("div",Z,[n("div",_,[s(L,{items:t.provinces,item:t.city,onOnSelectItem:t.onSelectCity},null,8,["items","item","onOnSelectItem"]),s(m,{outlined:"",class:"q-mt-sm",modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.name=i),rules:[t.rules.required,t.rules.min3],label:t.$t("inputName")+"("+t.$t("realStateName")+")"},null,8,["modelValue","rules","label"]),s(m,{outlined:"",class:"q-mt-sm",modelValue:t.email,"onUpdate:modelValue":e[1]||(e[1]=i=>t.email=i),rules:[t.rules.required,t.rules.min3,t.rules.email],label:t.$t("inputEmail")},null,8,["modelValue","rules","label"]),s(m,{outlined:"",class:"col-8",type:"tel",maxlength:"11",modelValue:t.phone,"onUpdate:modelValue":e[2]||(e[2]=i=>t.phone=i),rules:[t.rules.required,t.rules.is11],label:t.$t("inputPhone")},{hint:a(()=>[r(" 0900-000-00-00 ")]),_:1},8,["modelValue","rules","label"]),s(m,{outlined:"",class:"q-mt-sm",modelValue:t.password,"onUpdate:modelValue":e[3]||(e[3]=i=>t.password=i),rules:[t.rules.required,t.rules.min8],type:"password",label:t.$t("inputPassword")},null,8,["modelValue","rules","label"]),s(m,{outlined:"",class:"q-mt-sm",modelValue:t.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=i=>t.confirmPassword=i),rules:[t.rules.required,t.rules.min8],type:"password",label:t.$t("inputConfirmPassword")},null,8,["modelValue","rules","label"]),s(c,{loading:t.loading,onClick:t.register,class:"full-width q-mt-sm ad-primary-btn"},{default:a(()=>[r(l(t.$t("signup")),1)]),_:1},8,["loading","onClick"])])])):t.form2?(p(),M(b,{key:1,bordered:"",class:"q-pa-sm q-mx-sm",flat:""},{default:a(()=>[n("div",x,[n("div",tt,l(t.$t("verifyAccount")),1),s(S,{style:H("direction: "+t.$t("direction"))},{default:a(()=>[s(O,{time:t.countDownTime},{default:a(({minutes:i,seconds:v})=>[n("span",et,l(`${v}`.length==2?v:"0"+v)+": "+l(`${i}`.length==2?i:"0"+i),1)]),_:1},8,["time"])]),_:1},8,["style"]),s(S,null,{default:a(()=>[r(" \u06A9\u062F \u0634\u0645\u0627 "),st,r(" \u0627\u0633\u062A ")]),_:1}),s(m,{outlined:"",class:"q-mt-sm",modelValue:t.code,"onUpdate:modelValue":e[5]||(e[5]=i=>t.code=i),rules:[t.rules.required],label:t.$t("inputVerificationCode")},null,8,["modelValue","rules","label"]),s(c,{onClick:t.codeVerify,class:"full-width q-mt-sm ad-primary-btn"},{default:a(()=>[r(l(t.$t("submit")),1)]),_:1},8,["onClick"])]),s(G,null,{default:a(()=>[t.$t("direction")=="rtl"?(p(),M(F,{key:0})):V("",!0),s(c,{onClick:e[6]||(e[6]=i=>(t.form2=!1,t.form1=!0)),dense:"",flat:"",color:"primary"},{default:a(()=>[r(l(t.$t("back")),1)]),_:1})]),_:1}),s(b,{bordered:"",class:"q-pa-sm q-ma-sm",flat:""},{default:a(()=>[n("span",null,l(t.$t("didnotRecieveCode")),1),s(c,{"no-caps":"",dense:"",flat:"",disable:t.disable,loading:t.loading,class:"q-mx-xs",color:"primary",onClick:t.register},{default:a(()=>[r(l(t.$t("tryAgain")),1)]),_:1},8,["disable","loading","onClick"])]),_:1})]),_:1})):V("",!0),s(b,{bordered:"",class:"q-pa-sm q-ma-sm",flat:""},{default:a(()=>[n("span",null,l(t.$t("haveAnAccount")),1),s(c,{"no-caps":"",dense:"",flat:"",class:"q-mx-xs",color:"primary",onClick:e[7]||(e[7]=i=>t.$router.push("/accounts/login"))},{default:a(()=>[r(l(t.$t("login")),1)]),_:1})]),_:1})])])]),_:1})}var bt=P(K,[["render",it]]);export{bt as default};
